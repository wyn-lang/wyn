// compiler_modular.wyn - Minimal working standalone compiler
// Avoids compiler bugs by using simple patterns

fn main() -> int {
    print("Wyn Compiler v1.5.0")
    
    var source = "var x = 42"
    print("Source:")
    print(source)
    
    var c_code = compile(source)
    print("Generated C:")
    print(c_code)
    
    return 0
}

fn compile(source: string) -> string {
    var output = "#include <stdio.h>\n\nint main() {\n"
    
    var has_var = 0
    var i = 0
    while i < source.len() {
        if i + 3 <= source.len() {
            if source[i] == "v" && source[i+1] == "a" && source[i+2] == "r" {
                has_var = 1
            }
        }
        i = i + 1
    }
    
    if has_var == 1 {
        output = output + "    int x = 42;\n"
    }
    
    output = output + "    return 0;\n}\n"
    return output
}
