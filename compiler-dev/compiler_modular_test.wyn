// compiler_modular.wyn - Integrated compiler with module imports
// Attempts to use module system despite known limitations

import lexer_module
import parser_module
import checker_module
import codegen_module

fn main() -> int {
    print("=== Wyn Modular Compiler ===")
    
    // Test input
    var source = "var x = 42"
    
    print("Step 1: Lexing...")
    var tokens = lexer_module_tokenize(source)
    print("Tokens: ")
    print(tokens.len())
    
    print("Step 2: Parsing...")
    var ast = parser_module_parse(tokens)
    print("AST nodes: ")
    print(ast.len())
    
    print("Step 3: Type checking...")
    var errors = checker_module_check(ast)
    print("Errors: ")
    print(errors)
    
    if errors > 0 {
        print("Compilation result: FAILED")
        return 1
    }
    
    print("Step 4: Code generation...")
    var c_code = codegen_module_generate(ast)
    print("C code length: ")
    print(c_code.len())
    
    print("Compilation result: SUCCESS")
    return 0
}
